/*!
 * DJ Mountainous - Dj Mountainous v1.1.1 (djmountainous.com)
 * Copyright 2016-2016 Corey Sanford
 */
"use strict";function collapseNavbar(){$(".navbar").offset().top>$("#waves").offset().top-150?$(".navbar-fixed-top").addClass("top-nav-collapse"):$(".navbar-fixed-top").removeClass("top-nav-collapse")}$(function(){var t=[1,2,4,8,10,25,50,75,95],i=function(t){this.$audioPlayer=t,this.stub=this.$audioPlayer.attr("id"),this.rating=this.$audioPlayer.data("rating"),this.$playPauseBtn=this.$audioPlayer.find(".play-pause").eq(0),this.$track=this.$audioPlayer.find("audio").eq(0),this.track=this.$track.get(0),this.isPastMilestone={},this.constructMilestones(),this.$progressBar=this.$audioPlayer.find(".progress-bar").eq(0),this.$buffer=this.$progressBar.find(".buffer").eq(0),this.$played=this.$progressBar.find(".played").eq(0),this.$currentTime=this.$audioPlayer.find(".current-time").eq(0),this.$mixLength=this.$audioPlayer.find(".mix-length").eq(0),this.$divider=this.$audioPlayer.find(".divider").eq(0),this.trackRefreshTimer=null};i.prototype.constructMilestones=function(){var i=this;t.forEach(function(t){i.isPastMilestone[t]=!1})},i.prototype.sendProgressEvents=function(){var i=this,a=this.track.currentTime/this.track.duration*100;t.forEach(function(t){a>t&&(i.isPastMilestone[t]||(i.isPastMilestone[t]=!0,ga("send","event","Mix","progress-"+t,i.stub)))})},i.prototype.pauseAllOthers=function(){$(".audio-player").not(this.$audioPlayer).each(function(){var t=new i($(this));t.pauseTrack()})},i.prototype.isPaused=function(){return this.track.paused},i.prototype.pauseTrack=function(t){this.track.pause(),this.$audioPlayer.removeClass("playing"),this.$progressBar.removeClass("expanded")},i.prototype.playTrack=function(t){ga("send","event","Mix","play",this.stub,this.rating),this.pauseAllOthers(),this.track.play(),this.$audioPlayer.addClass("playing"),this.$progressBar.addClass("expanded"),this.startInterval(),this.$currentTime.text(this.currentTimeString()),this.$divider.show(),this.$mixLength.text(this.durationString())},i.prototype.startInterval=function(){this.trackRefreshTimer=setInterval(this.tick.bind(this),100)},i.prototype.clearInterval=function(){clearInterval(this.trackRefreshTimer)},i.prototype.tick=function(){this.$currentTime.text(this.currentTimeString()),this.updateProgressBar(),this.sendProgressEvents()},i.prototype.updateProgressBar=function(){var t=this.track.currentTime/this.track.duration*100;this.$played.css("width",t+"%")},i.prototype.currentTimeString=function(){return this.timeString(this.track.currentTime)},i.prototype.durationString=function(){return this.timeString(this.track.duration)},i.prototype.timeString=function(t){if(isNaN(t)){if(isNaN(this.track.duration))return"";this.track.duration}var i="0"+Math.round(t%60);return i=i.substr(i.length-2),Math.round(t/60)+":"+i},i.prototype.togglePlayPause=function(){this.isPaused()?this.playTrack():this.pauseTrack()},i.prototype.seek=function(t){var i=t.offsetX/$(t.target).width();this.track.currentTime=i*this.track.duration,this.updateProgressBar()},$("body").on("click",".play-pause",function(){var t=new i($(this).closest(".audio-player").eq(0));t.togglePlayPause()}),$("body").on("click",".progress-bar",function(t){var a=new i($(this).closest(".audio-player").eq(0));a.seek(t)}),$("body").on("click",".download",function(t){ga("send","event","Mix","download",$(this).closest(".audio-player").attr("id"),$(this).closest(".audio-player").data("rating"))})}),$(window).scroll(collapseNavbar),$(document).ready(collapseNavbar),$(function(){$("a.page-scroll").bind("click",function(t){var i=$(this);$("html, body").stop().animate({scrollTop:$(i.attr("href")).offset().top-150},1e3,"easeInOutExpo"),t.preventDefault()})}),$(".navbar-collapse ul li a").click(function(){"dropdown-toggle active"!=$(this).attr("class")&&"dropdown-toggle"!=$(this).attr("class")&&$(".navbar-toggle:visible").click()}),$(function(){function t(t){$(".v-descriptions > p").not('.v-descriptions > p[data-rating="'+t+'"]').hide(),$(".bottom-bar > div .rating-block").not('.bottom-bar > div .rating-block[data-rating="'+t+'"]').css("opacity",a).removeClass("active"),$('.bottom-bar > div .rating-block[data-rating="'+t+'"]').css("opacity",1).addClass("active"),$('.v-descriptions > p[data-rating="'+t+'"]').show()}var i=480,a="0.4",e="0.5",r=$(".bottom-bar .rating-block"),s=r.length;r.eq(0).height();0!==s&&(setInterval(function(){var t=Math.floor(Math.random()*s)+1;r.not(".active").css("opacity",a);for(var i=0;i<t;i++){var n=Math.floor(Math.random()*s)+1;r.eq(n).hasClass("active")||r.eq(n).css("opacity",e)}},i),$(".bottom-bar > div").on("click",function(){var i=$(this).find(".rating-block").data("rating");t(i)}))}),$(function(){window.location.search.replace("?","");$("*").on("click",function(){$(".mix").css("opacity",1)}),$("#mixes").on("click",".mix__details .rating",function(){$('.rating-block[data-rating="'+$(this).data("rating")+'"]').closest("div").trigger("hover"),$('.rating-block[data-rating="'+$(this).data("rating")+'"]').closest("div").trigger("click"),$("html, body").scrollTop($(".bottom-bar").offset().top-130)})}),$(function(){function t(t,i){var a=MyApp.templates.mixes(t);$("#mixes-tmpl-"+i).html(a)}var i={mixes:[{title:"The Eiger",genres:"Tech House",date:"Sept 2016",slug:"va-tech-house",rating:3},{title:"Garibaldi",genres:"Deep House",date:"June 2016",slug:"va-deep-house-v2",rating:2}]},a={mixes:[{title:"Blueprint 19th Warmup",genres:"Rezz Griz Grime W.S.N DFrancis",date:"October 2016",slug:"blueprint-19-warmup",rating:9},{title:"Live @ BirthRave 2016",genres:"Bass Funk, Trap, Dub",date:"Sept 24, 2016",slug:"live-birthrave-2016-bass-funk-dub",rating:8},{title:"Black Tusk",genres:"Trap & Dubstep",date:"August 2016",slug:"va-dubtrap",rating:9},{title:"Seven Lions warmup",genres:"Dreamstep",date:"October 2016",slug:"seven-lions-warm-up-mix",rating:7}]};t(a,"intense"),t(i,"calm")});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbC1taW4uanMiLCJncmF5c2NhbGUuanMiLCJhdWRpby1wbGF5ZXIuanMiLCJob21lcGFnZS1hbmltYXRpb25zLmpzIiwic2l0ZS5qcyJdLCJuYW1lcyI6WyJjb2xsYXBzZU5hdmJhciIsIiQiLCJvZmZzZXQiLCJ0b3AiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwicHJvZ3Jlc3NNaWxlc3RvbmVzIiwiYXVkaW9QbGF5ZXIiLCIkYXVkaW9QbGF5ZXIiLCJ0aGlzIiwic3R1YiIsImF0dHIiLCJyYXRpbmciLCJkYXRhIiwiJHBsYXlQYXVzZUJ0biIsImZpbmQiLCJlcSIsIiR0cmFjayIsInRyYWNrIiwiZ2V0IiwiaXNQYXN0TWlsZXN0b25lIiwiY29uc3RydWN0TWlsZXN0b25lcyIsIiRwcm9ncmVzc0JhciIsIiRidWZmZXIiLCIkcGxheWVkIiwiJGN1cnJlbnRUaW1lIiwiJG1peExlbmd0aCIsIiRkaXZpZGVyIiwidHJhY2tSZWZyZXNoVGltZXIiLCJwcm90b3R5cGUiLCJfdGhpcyIsImZvckVhY2giLCJtaWxlc3RvbmUiLCJzZW5kUHJvZ3Jlc3NFdmVudHMiLCJfdGhpczIiLCJwcm9ncmVzcyIsImN1cnJlbnRUaW1lIiwiZHVyYXRpb24iLCJnYSIsInBhdXNlQWxsT3RoZXJzIiwibm90IiwiZWFjaCIsInBsYXlyIiwicGF1c2VUcmFjayIsImlzUGF1c2VkIiwicGF1c2VkIiwicGF1c2UiLCJwbGF5VHJhY2siLCJwbGF5Iiwic3RhcnRJbnRlcnZhbCIsInRleHQiLCJjdXJyZW50VGltZVN0cmluZyIsInNob3ciLCJkdXJhdGlvblN0cmluZyIsInNldEludGVydmFsIiwidGljayIsImJpbmQiLCJjbGVhckludGVydmFsIiwidXBkYXRlUHJvZ3Jlc3NCYXIiLCJwbGF5UGVyY2VudGFnZSIsImNzcyIsInRpbWVTdHJpbmciLCJ0aW1lIiwiaXNOYU4iLCJzZWNvbmRzIiwiTWF0aCIsInJvdW5kIiwic3Vic3RyIiwibGVuZ3RoIiwidG9nZ2xlUGxheVBhdXNlIiwic2VlayIsImV2ZW50Iiwib2Zmc2V0WCIsInRhcmdldCIsIndpZHRoIiwib24iLCJwbGF5ZXIiLCJjbG9zZXN0Iiwid2luZG93Iiwic2Nyb2xsIiwiZG9jdW1lbnQiLCJyZWFkeSIsIiRhbmNob3IiLCJzdG9wIiwiYW5pbWF0ZSIsInNjcm9sbFRvcCIsInByZXZlbnREZWZhdWx0IiwiY2xpY2siLCJzaG93QW5kSGlnaGxpZ2h0UmF0aW5nIiwiaGlkZSIsIkRFRkFVTFRfT1BBQ0lUWSIsIkFOSU1BVElPTl9QRVJJT0QiLCJJTkNSRUFTRURfT1BBQ0lUWSIsIiRyYXRpbmdfYmxvY2tzIiwibnVtX3JhdGluZ3MiLCJoZWlnaHQiLCJibG9ja3NfdG9fYmxhbmsiLCJmbG9vciIsInJhbmRvbSIsImkiLCJyYW5kX2Jsb2NrX2luZGV4IiwiaGFzQ2xhc3MiLCJsb2NhdGlvbiIsInNlYXJjaCIsInJlcGxhY2UiLCJ0cmlnZ2VyIiwiaW5qZWN0VGVtcGxhdGVzIiwidHlwZSIsImh0bWwiLCJNeUFwcCIsInRlbXBsYXRlcyIsIm1peGVzIiwiY2FsbV9taXhlcyIsInRpdGxlIiwiZ2VucmVzIiwiZGF0ZSIsInNsdWciLCJpbnRlbnNlX21peGVzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsWUNPQSxTQUFTQSxrQkFDREMsRUFBRSxXQUFXQyxTQUFTQyxJQUFNRixFQUFFLFVBQVVDLFNBQVNDLElBQU0sSUFDdkRGLEVBQUUscUJBQXFCRyxTQUFTLG9CQUVoQ0gsRUFBRSxxQkFBcUJJLFlBQVksb0JDUDNDSixFQUFFLFdBRUEsR0FBTUssSUFBc0IsRUFBRyxFQUFHLEVBQUcsRUFBRyxHQUFJLEdBQUksR0FBSSxHQUFJLElBRXBEQyxFQUFjLFNBQVNDLEdBRXpCQyxLQUFLRCxhQUFlQSxFQUNwQkMsS0FBS0MsS0FBT0QsS0FBS0QsYUFBYUcsS0FBSyxNQUNuQ0YsS0FBS0csT0FBU0gsS0FBS0QsYUFBYUssS0FBSyxVQUVyQ0osS0FBS0ssY0FBZ0JMLEtBQUtELGFBQWFPLEtBQUssZUFBZUMsR0FBRyxHQUM5RFAsS0FB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TSxlQUNOQyxLQUFNLDBCQUNOeEcsT0FBUSxJQU1kOEYsR0FBZ0JXLEVBQWdCLFdBQ2hDWCxFQUFnQk0sRUFBZ0IiLCJmaWxlIjoiYWxsLW1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxNZWRpYUVsZW1lbnRcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0d1aWRlL0hUTUwvVXNpbmdfSFRNTDVfYXVkaW9fYW5kX3ZpZGVvXG5cbiQoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBwcm9ncmVzc01pbGVzdG9uZXMgPSBbMSwgMiwgNCwgOCwgMTAsIDI1LCA1MCwgNzUsIDk1XTtcblxuICB2YXIgYXVkaW9QbGF5ZXIgPSBmdW5jdGlvbiBhdWRpb1BsYXllcigkYXVkaW9QbGF5ZXIpIHtcblxuICAgIHRoaXMuJGF1ZGlvUGxheWVyID0gJGF1ZGlvUGxheWVyO1xuICAgIHRoaXMuc3R1YiA9IHRoaXMuJGF1ZGlvUGxheWVyLmF0dHIoJ2lkJyk7XG4gICAgdGhpcy5yYXRpbmcgPSB0aGlzLiRhdWRpb1BsYXllci5kYXRhKCdyYXRpbmcnKTtcblxuICAgIHRoaXMuJHBsYXlQYXVzZUJ0biA9IHRoaXMuJGF1ZGlvUGxheWVyLmZpbmQoJy5wbGF5LXBhdXNlJykuZXEoMCk7XG4gICAgdGhpcy4kdHJhY2sgPSB0aGlzLiRhdWRpb1BsYXllci5maW5kKCdhdWRpbycpLmVxKDApO1xuICAgIHRoaXMudHJhY2sgPSB0aGlzLiR0cmFjay5nZXQoMCk7XG5cbiAgICB0aGlzLmlzUGFzdE1pbGVzdG9uZSA9IHt9OyAvL2V2ZW50dWFsbHkgcG9wdWxhdGVkIHdpdGggcHJvZ3Jlc3MgTWlsZXN0b25lcyBhcyBsaXN0ZWQgaW4gcHJvZ3Jlc3NNaWxlc3RvbmVzIGFycmF5XG4gICAgdGhpcy5jb25zdHJ1Y3RNaWxlc3RvbmVzKCk7XG5cbiAgICB0aGlzLiRwcm9ncmVzc0JhciA9IHRoaXMuJGF1ZGlvUGxheWVyLmZpbmQoJy5wcm9ncmVzcy1iYXInKS5lcSgwKTtcbiAgICB0aGlzLiRidWZmZXIgPSB0aGlzLiRwcm9ncmVzc0Jhci5maW5kKCcuYnVmZmVyJykuZXEoMCk7XG4gICAgdGhpcy4kcGxheWVkID0gdGhpcy4kcHJvZ3Jlc3NCYXIuZmluZCgnLnBsYXllZCcpLmVxKDApO1xuXG4gICAgdGhpcy4kY3VycmVudFRpbWUgPSB0aGlzLiRhdWRpb1BsYXllci5maW5kKCcuY3VycmVudC10aW1lJykuZXEoMCk7XG4gICAgdGhpcy4kbWl4TGVuZ3RoID0gdGhpcy4kYXVkaW9QbGF5ZXIuZmluZCgnLm1peC1sZW5ndGgnKS5lcSgwKTtcbiAgICB0aGlzLiRkaXZpZGVyID0gdGhpcy4kYXVkaW9QbGF5ZXIuZmluZCgnLmRpdmlkZXInKS5lcSgwKTtcblxuICAgIHRoaXMudHJhY2tSZWZyZXNoVGltZXIgPSBudWxsO1xuICB9O1xuXG4gIGF1ZGlvUGxheWVyLnByb3RvdHlwZS5jb25zdHJ1Y3RNaWxlc3RvbmVzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBwcm9ncmVzc01pbGVzdG9uZXMuZm9yRWFjaChmdW5jdGlvbiAobWlsZXN0b25lKSB7XG4gICAgICBfdGhpcy5pc1Bhc3RNaWxlc3RvbmVbbWlsZXN0b25lXSA9IGZhbHNlO1xuICAgIH0pO1xuICB9O1xuXG4gIC8qXG4gICAgIEtlZXAgY2hlY2tpbmcgaWYgcHJvZ3Jlc3MgaXMgcGFzdCB0aGUgbmV4dCBtaWxlc3RvbmVcbiAgICAgSWYgaXQgaXMsIGxvZyBhIHByb2dyZXNzIGV2ZW50IGFuZCBlbnN1cmUgXG4gICAgbm8gbW9yZSBwcm9ncmVzcyBldmVudHMgYXJlIHNlbnQgZm9yIHRoaXMgbWl4XG4gICAqL1xuICBhdWRpb1BsYXllci5wcm90b3R5cGUuc2VuZFByb2dyZXNzRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIHByb2dyZXNzID0gdGhpcy50cmFjay5jdXJyZW50VGltZSAvIHRoaXMudHJhY2suZHVyYXRpb24gKiAxMDA7XG5cbiAgICBwcm9ncmVzc01pbGVzdG9uZXMuZm9yRWFjaChmdW5jdGlvbiAobWlsZXN0b25lKSB7XG4gICAgICBpZiAocHJvZ3Jlc3MgPiBtaWxlc3RvbmUpIHtcbiAgICAgICAgaWYgKCFfdGhpczIuaXNQYXN0TWlsZXN0b25lW21pbGVzdG9uZV0pIHtcbiAgICAgICAgICAvL3Bhc3QgbWlsZXN0b25lIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAgIF90aGlzMi5pc1Bhc3RNaWxlc3RvbmVbbWlsZXN0b25lXSA9IHRydWU7XG4gICAgICAgICAgZ2EoJ3NlbmQnLCAnZXZlbnQnLCAnTWl4JywgJ3Byb2dyZXNzLScgKyBtaWxlc3RvbmUsIF90aGlzMi5zdHViKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIC8vUGF1c2UgYWxsIHRyYWNrcyBvbiB0aGUgcGFnZSBvdGhlciB0aGFuICd0aGlzJyBvbmVcbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnBhdXNlQWxsT3RoZXJzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgJCgnLmF1ZGlvLXBsYXllcicpLm5vdCh0aGlzLiRhdWRpb1BsYXllcikuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgcGxheXIgPSBuZXcgYXVkaW9QbGF5ZXIoJCh0aGlzKSk7XG4gICAgICBwbGF5ci5wYXVzZVRyYWNrKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy9jaGVjayBpZiB0aGlzIHBsYXllciBpcyBwYXVzZWRcbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLmlzUGF1c2VkID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLnRyYWNrLnBhdXNlZDtcbiAgfTtcblxuICBhdWRpb1BsYXllci5wcm90b3R5cGUucGF1c2VUcmFjayA9IGZ1bmN0aW9uICgkYXVkaW9QbGF5ZXIpIHtcbiAgICB0aGlzLnRyYWNrLnBhdXNlKCk7XG4gICAgdGhpcy4kYXVkaW9QbGF5ZXIucmVtb3ZlQ2xhc3MoJ3BsYXlpbmcnKTtcbiAgICB0aGlzLiRwcm9ncmVzc0Jhci5yZW1vdmVDbGFzcygnZXhwYW5kZWQnKTtcbiAgfTtcbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnBsYXlUcmFjayA9IGZ1bmN0aW9uICgkYXVkaW9QbGF5ZXIpIHtcblxuICAgIGdhKCdzZW5kJywgJ2V2ZW50JywgJ01peCcsICdwbGF5JywgdGhpcy5zdHViLCB0aGlzLnJhdGluZyk7XG5cbiAgICB0aGlzLnBhdXNlQWxsT3RoZXJzKCk7XG4gICAgdGhpcy50cmFjay5wbGF5KCk7XG4gICAgdGhpcy4kYXVkaW9QbGF5ZXIuYWRkQ2xhc3MoJ3BsYXlpbmcnKTtcbiAgICB0aGlzLiRwcm9ncmVzc0Jhci5hZGRDbGFzcygnZXhwYW5kZWQnKTtcblxuICAgIHRoaXMuc3RhcnRJbnRlcnZhbCgpO1xuXG4gICAgdGhpcy4kY3VycmVudFRpbWUudGV4dCh0aGlzLmN1cnJlbnRUaW1lU3RyaW5nKCkpO1xuICAgIHRoaXMuJGRpdmlkZXIuc2hvdygpO1xuICAgIHRoaXMuJG1peExlbmd0aC50ZXh0KHRoaXMuZHVyYXRpb25TdHJpbmcoKSk7XG4gIH07XG5cbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnN0YXJ0SW50ZXJ2YWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy50cmFja1JlZnJlc2hUaW1lciA9IHNldEludGVydmFsKHRoaXMudGljay5iaW5kKHRoaXMpLCAxMDApO1xuICB9O1xuICBhdWRpb1BsYXllci5wcm90b3R5cGUuY2xlYXJJbnRlcnZhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjbGVhckludGVydmFsKHRoaXMudHJhY2tSZWZyZXNoVGltZXIpO1xuICB9O1xuXG4gIC8vIE9uZSB0aWNrIG9mIHRoZSBzb25nIHJvbGxzIGJ5IGFuZCB0aGUgdGltZSBpcyB1cGRhdGVcbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnRpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy4kY3VycmVudFRpbWUudGV4dCh0aGlzLmN1cnJlbnRUaW1lU3RyaW5nKCkpO1xuICAgIHRoaXMudXBkYXRlUHJvZ3Jlc3NCYXIoKTtcbiAgICB0aGlzLnNlbmRQcm9ncmVzc0V2ZW50cygpO1xuICB9O1xuXG4gIGF1ZGlvUGxheWVyLnByb3RvdHlwZS51cGRhdGVQcm9ncmVzc0JhciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcGxheVBlcmNlbnRhZ2UgPSB0aGlzLnRyYWNrLmN1cnJlbnRUaW1lIC8gdGhpcy50cmFjay5kdXJhdGlvbiAqIDEwMDtcbiAgICB0aGlzLiRwbGF5ZWQuY3NzKCd3aWR0aCcsIHBsYXlQZXJjZW50YWdlICsgJyUnKTtcbiAgfTtcblxuICBhdWRpb1BsYXllci5wcm90b3R5cGUuY3VycmVudFRpbWVTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMudGltZVN0cmluZyh0aGlzLnRyYWNrLmN1cnJlbnRUaW1lKTtcbiAgfTtcblxuICBhdWRpb1BsYXllci5wcm90b3R5cGUuZHVyYXRpb25TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMudGltZVN0cmluZyh0aGlzLnRyYWNrLmR1cmF0aW9uKTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgdGltZSBsaWtlIE1NOlNTXG4gIGF1ZGlvUGxheWVyLnByb3RvdHlwZS50aW1lU3RyaW5nID0gZnVuY3Rpb24gKHRpbWUpIHtcblxuICAgIGlmIChpc05hTih0aW1lKSkge1xuICAgICAgLy9lZWssIHRyeSBhZ2Fpbi4gSGFyZCB0byByZXByb2R1Y2VcbiAgICAgIGlmIChpc05hTih0aGlzLnRyYWNrLmR1cmF0aW9uKSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnRyYWNrLmR1cmF0aW9uO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBzZWNvbmRzID0gXCIwXCIgKyBNYXRoLnJvdW5kKHRpbWUgJSA2MCk7XG4gICAgc2Vjb25kcyA9IHNlY29uZHMuc3Vic3RyKHNlY29uZHMubGVuZ3RoIC0gMik7XG5cbiAgICByZXR1cm4gTWF0aC5yb3VuZCh0aW1lIC8gNjApICsgJzonICsgc2Vjb25kcztcbiAgfTtcblxuICAvLyBQbGF5IGlmIHBhdXNlZCwgcGF1c2UgaWYgcGxheWluZ1xuICBhdWRpb1BsYXllci5wcm90b3R5cGUudG9nZ2xlUGxheVBhdXNlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNQYXVzZWQoKSA/IHRoaXMucGxheVRyYWNrKCkgOiB0aGlzLnBhdXNlVHJhY2soKTtcbiAgfTtcblxuICBhdWRpb1BsYXllci5wcm90b3R5cGUuc2VlayA9IGZ1bmN0aW9uIChldmVudCkge1xuXG4gICAgdmFyIHBsYXlQZXJjZW50YWdlID0gZXZlbnQub2Zmc2V0WCAvICQoZXZlbnQudGFyZ2V0KS53aWR0aCgpO1xuICAgIHRoaXMudHJhY2suY3VycmVudFRpbWUgPSBwbGF5UGVyY2VudGFnZSAqIHRoaXMudHJhY2suZHVyYXRpb247XG4gICAgdGhpcy51cGRhdGVQcm9ncmVzc0JhcigpO1xuICB9O1xuXG4gICQoJ2JvZHknKS5vbignY2xpY2snLCAnLnBsYXktcGF1c2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHBsYXllciA9IG5ldyBhdWRpb1BsYXllcigkKHRoaXMpLmNsb3Nlc3QoJy5hdWRpby1wbGF5ZXInKS5lcSgwKSk7XG4gICAgcGxheWVyLnRvZ2dsZVBsYXlQYXVzZSgpO1xuICB9KTtcblxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJy5wcm9ncmVzcy1iYXInLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgcGxheWVyID0gbmV3IGF1ZGlvUGxheWVyKCQodGhpcykuY2xvc2VzdCgnLmF1ZGlvLXBsYXllcicpLmVxKDApKTtcbiAgICBwbGF5ZXIuc2VlayhldmVudCk7XG4gIH0pO1xuXG4gIC8vc2VuZCBnb29nbGUtYW5hbHl0aWNzIHN0YXRzIGZvciBhIG1peCBkb3dubG9hZFxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJy5kb3dubG9hZCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGdhKCdzZW5kJywgJ2V2ZW50JywgJ01peCcsICdkb3dubG9hZCcsICQodGhpcykuY2xvc2VzdCgnLmF1ZGlvLXBsYXllcicpLmF0dHIoJ2lkJyksICQodGhpcykuY2xvc2VzdCgnLmF1ZGlvLXBsYXllcicpLmRhdGEoJ3JhdGluZycpKTtcbiAgfSk7XG59KTtcblwidXNlIHN0cmljdFwiO1xuXG4vKiFcbiAqIFN0YXJ0IEJvb3RzdHJhcCAtIEdyYXlzY2FsZSBCb290c3RyYXAgVGhlbWUgKGh0dHA6Ly9zdGFydGJvb3RzdHJhcC5jb20pXG4gKiBDb2RlIGxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSB2Mi4wLlxuICogRm9yIGRldGFpbHMsIHNlZSBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAuXG4gKi9cblxuLy8galF1ZXJ5IHRvIGNvbGxhcHNlIHRoZSBuYXZiYXIgb24gc2Nyb2xsXG5mdW5jdGlvbiBjb2xsYXBzZU5hdmJhcigpIHtcbiAgICBpZiAoJChcIi5uYXZiYXJcIikub2Zmc2V0KCkudG9wID4gJChcIiN3YXZlc1wiKS5vZmZzZXQoKS50b3AgLSAxNTApIHtcbiAgICAgICAgJChcIi5uYXZiYXItZml4ZWQtdG9wXCIpLmFkZENsYXNzKFwidG9wLW5hdi1jb2xsYXBzZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAkKFwiLm5hdmJhci1maXhlZC10b3BcIikucmVtb3ZlQ2xhc3MoXCJ0b3AtbmF2LWNvbGxhcHNlXCIpO1xuICAgIH1cbn1cblxuJCh3aW5kb3cpLnNjcm9sbChjb2xsYXBzZU5hdmJhcik7XG4kKGRvY3VtZW50KS5yZWFkeShjb2xsYXBzZU5hdmJhcik7XG5cbi8vIGpRdWVyeSBmb3IgcGFnZSBzY3JvbGxpbmcgZmVhdHVyZSAtIHJlcXVpcmVzIGpRdWVyeSBFYXNpbmcgcGx1Z2luXG4kKGZ1bmN0aW9uICgpIHtcbiAgICAkKCdhLnBhZ2Utc2Nyb2xsJykuYmluZCgnY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyICRhbmNob3IgPSAkKHRoaXMpO1xuICAgICAgICAkKCdodG1sLCBib2R5Jykuc3RvcCgpLmFuaW1hdGUoe1xuICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKCRhbmNob3IuYXR0cignaHJlZicpKS5vZmZzZXQoKS50b3AgLSAxNTBcbiAgICAgICAgfSwgMTAwMCwgJ2Vhc2VJbk91dEV4cG8nKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbn0pO1xuXG4vLyBDbG9zZXMgdGhlIFJlc3BvbnNpdmUgTWVudSBvbiBNZW51IEl0ZW0gQ2xpY2tcbiQoJy5uYXZiYXItY29sbGFwc2UgdWwgbGkgYScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJCh0aGlzKS5hdHRyKCdjbGFzcycpICE9ICdkcm9wZG93bi10b2dnbGUgYWN0aXZlJyAmJiAkKHRoaXMpLmF0dHIoJ2NsYXNzJykgIT0gJ2Ryb3Bkb3duLXRvZ2dsZScpIHtcbiAgICAgICAgJCgnLm5hdmJhci10b2dnbGU6dmlzaWJsZScpLmNsaWNrKCk7XG4gICAgfVxufSk7XG4ndXNlIHN0cmljdCc7XG5cbi8qIFxuICBBbmltYXRlIHJhdGluZ3MgYmFyIGJ5IGNoYW5naW5nIG9wYWNpdHkgb2Ygc2V2ZXJhbCBibG9ja3NcbiAgKi9cbiQoZnVuY3Rpb24gKCkge1xuXG4gIC8vICA2MHMvMTI1YnBtID0gNDgwbXNcbiAgdmFyIEFOSU1BVElPTl9QRVJJT0QgPSA2MC4wIC8gMTI1ICogMTAwMDtcbiAgdmFyIERFRkFVTFRfT1BBQ0lUWSA9ICcwLjQnO1xuICB2YXIgSU5DUkVBU0VEX09QQUNJVFkgPSAnMC41JztcbiAgdmFyICRyYXRpbmdfYmxvY2tzID0gJCgnLmJvdHRvbS1iYXIgLnJhdGluZy1ibG9jaycpO1xuICB2YXIgbnVtX3JhdGluZ3MgPSAkcmF0aW5nX2Jsb2Nrcy5sZW5ndGg7XG4gIHZhciBvcmlnaW5hbF9ibG9ja19oZWlnaHQgPSAkcmF0aW5nX2Jsb2Nrcy5lcSgwKS5oZWlnaHQoKTtcblxuICBpZiAobnVtX3JhdGluZ3MgPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBFdmVyeSB4IG1zLCBkby4uLlxuICAvLyAgcmVzZXQgYWxsIG9wYWNpdGllc1xuICAvLyAgY2hvb3NlIHggcmFuZG9tIHJhdGluZyBibG9ja3MgdG8gZGFya2VuXG4gIC8vICBjaG9vc2UgYSByYW5kb20gYmxvY2sgZnJvbSB0aGF0IGdyb3VwIHRvIGRhcmtlbiwgb3ZlcmxhcCBva1xuICAvLyBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuXG4gICAgLy9lYWNoIHRpbWUsIGEgZGlmZmVyZW50IG51bWJlciBvZiBibG9ja3MgYXJlIGNob3NlblxuICAgIHZhciBibG9ja3NfdG9fYmxhbmsgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBudW1fcmF0aW5ncykgKyAxO1xuXG4gICAgJHJhdGluZ19ibG9ja3Mubm90KCcuYWN0aXZlJykuY3NzKCdvcGFjaXR5JywgREVGQVVMVF9PUEFDSVRZKTtcbiAgICAvLyAuY3NzKCdoZWlnaHQnLCBvcmlnaW5hbF9ibG9ja19oZWlnaHQrJ3B4Jyk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJsb2Nrc190b19ibGFuazsgaSsrKSB7XG4gICAgICB2YXIgcmFuZF9ibG9ja19pbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG51bV9yYXRpbmdzKSArIDE7XG5cbiAgICAgIGlmICghJHJhdGluZ19ibG9ja3MuZXEocmFuZF9ibG9ja19pbmRleCkuaGFzQ2xhc3MoJ2FjdGl2ZScpKSB7XG4gICAgICAgICRyYXRpbmdfYmxvY2tzLmVxKHJhbmRfYmxvY2tfaW5kZXgpLmNzcygnb3BhY2l0eScsIElOQ1JFQVNFRF9PUEFDSVRZKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIEFOSU1BVElPTl9QRVJJT0QpO1xuXG4gIC8vIGNvbnRyb2wgc2hvd2luZyBWLXJhdGluZyBkZXNjcmlwdGlvbnMgb24gaG92ZXIgb2YgVi1jb2xvciBidXR0b25cbiAgJCgnLmJvdHRvbS1iYXIgPiBkaXYnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHJhdGluZyA9ICQodGhpcykuZmluZCgnLnJhdGluZy1ibG9jaycpLmRhdGEoJ3JhdGluZycpO1xuICAgIHNob3dBbmRIaWdobGlnaHRSYXRpbmcocmF0aW5nKTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gc2hvd0FuZEhpZ2hsaWdodFJhdGluZyhyYXRpbmcpIHtcblxuICAgIC8vaGlkZSBhbGwgb3RoZXIgZGVzY3JpcHRpb25zXG4gICAgJCgnLnYtZGVzY3JpcHRpb25zID4gcCcpLm5vdCgnLnYtZGVzY3JpcHRpb25zID4gcFtkYXRhLXJhdGluZz1cIicgKyByYXRpbmcgKyAnXCJdJykuaGlkZSgpO1xuXG4gICAgLy9yZW1vdmUgb3RoZXIgYWN0aXZlIG9wYWNpdGllc1xuICAgICQoJy5ib3R0b20tYmFyID4gZGl2IC5yYXRpbmctYmxvY2snKS5ub3QoJy5ib3R0b20tYmFyID4gZGl2IC5yYXRpbmctYmxvY2tbZGF0YS1yYXRpbmc9XCInICsgcmF0aW5nICsgJ1wiXScpLmNzcygnb3BhY2l0eScsIERFRkFVTFRfT1BBQ0lUWSkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgJCgnLmJvdHRvbS1iYXIgPiBkaXYgLnJhdGluZy1ibG9ja1tkYXRhLXJhdGluZz1cIicgKyByYXRpbmcgKyAnXCJdJykuY3NzKCdvcGFjaXR5JywgMSkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgJCgnLnYtZGVzY3JpcHRpb25zID4gcFtkYXRhLXJhdGluZz1cIicgKyByYXRpbmcgKyAnXCJdJykuc2hvdygpO1xuICB9XG59KTtcblxuJChmdW5jdGlvbiAoKSB7XG5cbiAgLy9nZXQgdGhlIHN0dWIgZnJvbSB0aGUgdXJsLCBsaWtlIGRqbW91bnRhaW5vdXMuY29tP2JsdWVwcmludC0xOS13YXJtdXBcbiAgdmFyIHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gucmVwbGFjZShcIj9cIiwgXCJcIik7XG5cbiAgLy9zY3JvbGwgdGhhdCBlbGVtZW50J3MgdG9wICBcbiAgLy8gc2V0VGltZW91dChmdW5jdGlvbigpeyBcblxuICAvLyAgIC8vICQoJ2h0bWwsIGJvZHknKS5zY3JvbGxUb3AoJCgnLicrc2VhcmNoKS5vZmZzZXQoKS50b3AtMzAwKTtcbiAgLy8gICAvLyAkKCcubWl4Jykubm90KCcuJytzZWFyY2gpLmNzcygnb3BhY2l0eScsIDAuNik7XG4gIC8vICAgLy8gJCgnLm1peC1ncm91cF9fdGl0bGUsIC5ncm91cC1kZXNjcmlwdGlvbicpLmNzcygnb3BhY2l0eScsIDAuNik7XG4gIC8vIH0sIDE4MDApOyBcblxuICAvL3doZW4gYW55dGhpbmcgaXMgY2xpY2tlZCwgc2V0IHRoZSBvcGFjaXR5IG9mIHRoZSBtaXhlcyBiYWNrIHRvIDFcbiAgJCgnKicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAkKCcubWl4JykuY3NzKCdvcGFjaXR5JywgMSk7XG4gIH0pO1xuXG4gICQoJyNtaXhlcycpLm9uKCdjbGljaycsICcubWl4X19kZXRhaWxzIC5yYXRpbmcnLCBmdW5jdGlvbiAoKSB7XG4gICAgJCgnLnJhdGluZy1ibG9ja1tkYXRhLXJhdGluZz1cIicgKyAkKHRoaXMpLmRhdGEoJ3JhdGluZycpICsgJ1wiXScpLmNsb3Nlc3QoJ2RpdicpLnRyaWdnZXIoJ2hvdmVyJyk7XG4gICAgJCgnLnJhdGluZy1ibG9ja1tkYXRhLXJhdGluZz1cIicgKyAkKHRoaXMpLmRhdGEoJ3JhdGluZycpICsgJ1wiXScpLmNsb3Nlc3QoJ2RpdicpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgJCgnaHRtbCwgYm9keScpLnNjcm9sbFRvcCgkKCcuYm90dG9tLWJhcicpLm9mZnNldCgpLnRvcCAtIDEzMCk7XG4gIH0pO1xufSk7XG5cInVzZSBzdHJpY3RcIjtcblxuJChmdW5jdGlvbiAoKSB7XG5cbiAgLy8gbWl4ZXMgTVVTVCBiZSBuYW1lZCBkai1tb3V0YWlub3VzLXtzbHVnfS4obXAzL200YSlcbiAgLy8gaS5lLiBkai1tb3VudGFpbm91cy12YS10ZWNoLWhvdXNlXG5cbiAgdmFyIGNhbG1fbWl4ZXMgPSB7XG4gICAgbWl4ZXM6IFtcbiAgICAvL25ldyBtaXggZ29lcyBoZXJlXG4gICAge1xuICAgICAgdGl0bGU6IFwiVGhlIEVpZ2VyXCIsXG4gICAgICBnZW5yZXM6IFwiVGVjaCBIb3VzZVwiLFxuICAgICAgZGF0ZTogXCJTZXB0IDIwMTZcIixcbiAgICAgIHNsdWc6IFwidmEtdGVjaC1ob3VzZVwiLFxuICAgICAgcmF0aW5nOiAzXG4gICAgfSwge1xuICAgICAgdGl0bGU6IFwiR2FyaWJhbGRpXCIsXG4gICAgICBnZW5yZXM6IFwiRGVlcCBIb3VzZVwiLFxuICAgICAgZGF0ZTogXCJKdW5lIDIwMTZcIixcbiAgICAgIHNsdWc6IFwidmEtZGVlcC1ob3VzZS12MlwiLFxuICAgICAgcmF0aW5nOiAyXG4gICAgfV1cbiAgfTtcblxuICB2YXIgaW50ZW5zZV9taXhlcyA9IHtcbiAgICBtaXhlczogW1xuICAgIC8vbmV3IG1peCBnb2VzIGhlcmVcbiAgICB7XG4gICAgICB0aXRsZTogXCJCbHVlcHJpbnQgMTl0aCBXYXJtdXBcIixcbiAgICAgIGdlbnJlczogXCJSZXp6IEdyaXogR3JpbWUgVy5TLk4gREZyYW5jaXNcIixcbiAgICAgIGRhdGU6IFwiT2N0b2JlciAyMDE2XCIsXG4gICAgICBzbHVnOiBcImJsdWVwcmludC0xOS13YXJtdXBcIixcbiAgICAgIHJhdGluZzogOVxuICAgIH0sIHtcbiAgICAgIHRpdGxlOiBcIkxpdmUgQCBCaXJ0aFJhdmUgMjAxNlwiLFxuICAgICAgZ2VucmVzOiBcIkJhc3MgRnVuaywgVHJhcCwgRHViXCIsXG4gICAgICBkYXRlOiBcIlNlcHQgMjQsIDIwMTZcIixcbiAgICAgIHNsdWc6IFwibGl2ZS1iaXJ0aHJhdmUtMjAxNi1iYXNzLWZ1bmstZHViXCIsXG4gICAgICByYXRpbmc6IDhcbiAgICB9LCB7XG4gICAgICB0aXRsZTogXCJCbGFjayBUdXNrXCIsXG4gICAgICBnZW5yZXM6IFwiVHJhcCAmIER1YnN0ZXBcIixcbiAgICAgIGRhdGU6IFwiQXVndXN0IDIwMTZcIixcbiAgICAgIHNsdWc6IFwidmEtZHVidHJhcFwiLFxuICAgICAgcmF0aW5nOiA5XG4gICAgfSwge1xuICAgICAgdGl0bGU6IFwiU2V2ZW4gTGlvbnMgd2FybXVwXCIsXG4gICAgICBnZW5yZXM6IFwiRHJlYW1zdGVwXCIsXG4gICAgICBkYXRlOiBcIk9jdG9iZXIgMjAxNlwiLFxuICAgICAgc2x1ZzogXCJzZXZlbi1saW9ucy13YXJtLXVwLW1peFwiLFxuICAgICAgcmF0aW5nOiA3XG4gICAgfV1cbiAgfTsgLy8gaW50ZW5zZSBtaXhlc1xuXG4gIC8vIC8vaW5qZWN0IGhhbmRsZWJhcnMgdGVtcGxhdGVzIHdpdGggbWl4IGRhdGFcbiAgaW5qZWN0VGVtcGxhdGVzKGludGVuc2VfbWl4ZXMsICdpbnRlbnNlJyk7XG4gIGluamVjdFRlbXBsYXRlcyhjYWxtX21peGVzLCAnY2FsbScpO1xuXG4gIGZ1bmN0aW9uIGluamVjdFRlbXBsYXRlcyhkYXRhLCB0eXBlKSB7XG5cbiAgICB2YXIgaHRtbCA9IE15QXBwLnRlbXBsYXRlcy5taXhlcyhkYXRhKTtcbiAgICAkKCcjbWl4ZXMtdG1wbC0nICsgdHlwZSkuaHRtbChodG1sKTtcbiAgfVxufSk7IiwiLyohXG4gKiBTdGFydCBCb290c3RyYXAgLSBHcmF5c2NhbGUgQm9vdHN0cmFwIFRoZW1lIChodHRwOi8vc3RhcnRib290c3RyYXAuY29tKVxuICogQ29kZSBsaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UgdjIuMC5cbiAqIEZvciBkZXRhaWxzLCBzZWUgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wLlxuICovXG5cbi8vIGpRdWVyeSB0byBjb2xsYXBzZSB0aGUgbmF2YmFyIG9uIHNjcm9sbFxuZnVuY3Rpb24gY29sbGFwc2VOYXZiYXIoKSB7XG4gICAgaWYgKCQoXCIubmF2YmFyXCIpLm9mZnNldCgpLnRvcCA+ICQoXCIjd2F2ZXNcIikub2Zmc2V0KCkudG9wIC0gMTUwKSB7XG4gICAgICAgICQoXCIubmF2YmFyLWZpeGVkLXRvcFwiKS5hZGRDbGFzcyhcInRvcC1uYXYtY29sbGFwc2VcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIi5uYXZiYXItZml4ZWQtdG9wXCIpLnJlbW92ZUNsYXNzKFwidG9wLW5hdi1jb2xsYXBzZVwiKTtcbiAgICB9XG59XG5cbiQod2luZG93KS5zY3JvbGwoY29sbGFwc2VOYXZiYXIpO1xuJChkb2N1bWVudCkucmVhZHkoY29sbGFwc2VOYXZiYXIpO1xuXG4vLyBqUXVlcnkgZm9yIHBhZ2Ugc2Nyb2xsaW5nIGZlYXR1cmUgLSByZXF1aXJlcyBqUXVlcnkgRWFzaW5nIHBsdWdpblxuJChmdW5jdGlvbigpIHtcbiAgICAkKCdhLnBhZ2Utc2Nyb2xsJykuYmluZCgnY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICB2YXIgJGFuY2hvciA9ICQodGhpcyk7XG4gICAgICAgICQoJ2h0bWwsIGJvZHknKS5zdG9wKCkuYW5pbWF0ZSh7XG4gICAgICAgICAgICBzY3JvbGxUb3A6ICQoJGFuY2hvci5hdHRyKCdocmVmJykpLm9mZnNldCgpLnRvcC0xNTBcbiAgICAgICAgfSwgMTAwMCwgJ2Vhc2VJbk91dEV4cG8nKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbn0pO1xuXG4vLyBDbG9zZXMgdGhlIFJlc3BvbnNpdmUgTWVudSBvbiBNZW51IEl0ZW0gQ2xpY2tcbiQoJy5uYXZiYXItY29sbGFwc2UgdWwgbGkgYScpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICBpZiAoJCh0aGlzKS5hdHRyKCdjbGFzcycpICE9ICdkcm9wZG93bi10b2dnbGUgYWN0aXZlJyAmJiAkKHRoaXMpLmF0dHIoJ2NsYXNzJykgIT0gJ2Ryb3Bkb3duLXRvZ2dsZScpIHtcbiAgICAkKCcubmF2YmFyLXRvZ2dsZTp2aXNpYmxlJykuY2xpY2soKTtcbiAgfVxufSk7XG4iLCJcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9IVE1MTWVkaWFFbGVtZW50XG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9HdWlkZS9IVE1ML1VzaW5nX0hUTUw1X2F1ZGlvX2FuZF92aWRlb1xuXG4kKGZ1bmN0aW9uKCl7XG5cbiAgY29uc3QgcHJvZ3Jlc3NNaWxlc3RvbmVzID0gWzEsIDIsIDQsIDgsIDEwLCAyNSwgNTAsIDc1LCA5NV07XG5cbiAgdmFyIGF1ZGlvUGxheWVyID0gZnVuY3Rpb24oJGF1ZGlvUGxheWVyKXtcblxuICAgIHRoaXMuJGF1ZGlvUGxheWVyID0gJGF1ZGlvUGxheWVyO1xuICAgIHRoaXMuc3R1YiA9IHRoaXMuJGF1ZGlvUGxheWVyLmF0dHIoJ2lkJyk7XG4gICAgdGhpcy5yYXRpbmcgPSB0aGlzLiRhdWRpb1BsYXllci5kYXRhKCdyYXRpbmcnKTtcblxuICAgIHRoaXMuJHBsYXlQYXVzZUJ0biA9IHRoaXMuJGF1ZGlvUGxheWVyLmZpbmQoJy5wbGF5LXBhdXNlJykuZXEoMCk7XG4gICAgdGhpcy4kdHJhY2sgPSB0aGlzLiRhdWRpb1BsYXllci5maW5kKCdhdWRpbycpLmVxKDApO1xuICAgIHRoaXMudHJhY2sgPSB0aGlzLiR0cmFjay5nZXQoMCk7XG5cbiAgICB0aGlzLmlzUGFzdE1pbGVzdG9uZSA9IHt9OyAvL2V2ZW50dWFsbHkgcG9wdWxhdGVkIHdpdGggcHJvZ3Jlc3MgTWlsZXN0b25lcyBhcyBsaXN0ZWQgaW4gcHJvZ3Jlc3NNaWxlc3RvbmVzIGFycmF5XG4gICAgdGhpcy5jb25zdHJ1Y3RNaWxlc3RvbmVzKCk7XG5cbiAgICB0aGlzLiRwcm9ncmVzc0JhciA9IHRoaXMuJGF1ZGlvUGxheWVyLmZpbmQoJy5wcm9ncmVzcy1iYXInKS5lcSgwKTtcbiAgICB0aGlzLiRidWZmZXIgICAgICA9IHRoaXMuJHByb2dyZXNzQmFyLmZpbmQoJy5idWZmZXInKS5lcSgwKTtcbiAgICB0aGlzLiRwbGF5ZWQgICAgICA9IHRoaXMuJHByb2dyZXNzQmFyLmZpbmQoJy5wbGF5ZWQnKS5lcSgwKTtcblxuICAgIHRoaXMuJGN1cnJlbnRUaW1lID0gdGhpcy4kYXVkaW9QbGF5ZXIuZmluZCgnLmN1cnJlbnQtdGltZScpLmVxKDApO1xuICAgIHRoaXMuJG1peExlbmd0aCAgID0gdGhpcy4kYXVkaW9QbGF5ZXIuZmluZCgnLm1peC1sZW5ndGgnKS5lcSgwKTtcbiAgICB0aGlzLiRkaXZpZGVyICAgICA9IHRoaXMuJGF1ZGlvUGxheWVyLmZpbmQoJy5kaXZpZGVyJykuZXEoMCk7XG5cbiAgICB0aGlzLnRyYWNrUmVmcmVzaFRpbWVyID0gbnVsbDtcbiAgfVxuXG4gIGF1ZGlvUGxheWVyLnByb3RvdHlwZS5jb25zdHJ1Y3RNaWxlc3RvbmVzID0gZnVuY3Rpb24oKXtcbiAgICBwcm9ncmVzc01pbGVzdG9uZXMuZm9yRWFjaCgobWlsZXN0b25lKSA9PiB7XG4gICAgICB0aGlzLmlzUGFzdE1pbGVzdG9uZVttaWxlc3RvbmVdID0gZmFsc2U7XG4gICAgfSk7XG4gIH1cblxuICAvKlxuXG4gICAgS2VlcCBjaGVja2luZyBpZiBwcm9ncmVzcyBpcyBwYXN0IHRoZSBuZXh0IG1pbGVzdG9uZVxuXG4gICAgSWYgaXQgaXMsIGxvZyBhIHByb2dyZXNzIGV2ZW50IGFuZCBlbnN1cmUgXG4gICAgbm8gbW9yZSBwcm9ncmVzcyBldmVudHMgYXJlIHNlbnQgZm9yIHRoaXMgbWl4XG5cbiAgKi9cbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnNlbmRQcm9ncmVzc0V2ZW50cyA9IGZ1bmN0aW9uKCl7XG5cbiAgICBsZXQgcHJvZ3Jlc3MgPSAodGhpcy50cmFjay5jdXJyZW50VGltZSAvIHRoaXMudHJhY2suZHVyYXRpb24pICogMTAwO1xuXG4gICAgcHJvZ3Jlc3NNaWxlc3RvbmVzLmZvckVhY2goKG1pbGVzdG9uZSkgPT4ge1xuICAgICAgaWYocHJvZ3Jlc3MgPiBtaWxlc3RvbmUpe1xuICAgICAgICBpZighdGhpcy5pc1Bhc3RNaWxlc3RvbmVbbWlsZXN0b25lXSl7ICAvL3Bhc3QgbWlsZXN0b25lIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAgIHRoaXMuaXNQYXN0TWlsZXN0b25lW21pbGVzdG9uZV0gPSB0cnVlO1xuICAgICAgICAgIGdhKCdzZW5kJywgJ2V2ZW50JywgJ01peCcsICdwcm9ncmVzcy0nK21pbGVzdG9uZSwgdGhpcy5zdHViKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pOyBcbiAgfVxuXG4gIC8vUGF1c2UgYWxsIHRyYWNrcyBvbiB0aGUgcGFnZSBvdGhlciB0aGFuICd0aGlzJyBvbmVcbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnBhdXNlQWxsT3RoZXJzID0gZnVuY3Rpb24oKXtcblxuICAgICQoJy5hdWRpby1wbGF5ZXInKS5ub3QodGhpcy4kYXVkaW9QbGF5ZXIpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgIHZhciBwbGF5ciA9IG5ldyBhdWRpb1BsYXllcigkKHRoaXMpKTtcbiAgICAgIHBsYXlyLnBhdXNlVHJhY2soKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vY2hlY2sgaWYgdGhpcyBwbGF5ZXIgaXMgcGF1c2VkXG4gIGF1ZGlvUGxheWVyLnByb3RvdHlwZS5pc1BhdXNlZCA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMudHJhY2sucGF1c2VkO1xuICB9XG5cbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnBhdXNlVHJhY2sgPSBmdW5jdGlvbigkYXVkaW9QbGF5ZXIpe1xuICAgIHRoaXMudHJhY2sucGF1c2UoKTtcbiAgICB0aGlzLiRhdWRpb1BsYXllci5yZW1vdmVDbGFzcygncGxheWluZycpO1xuICAgIHRoaXMuJHByb2dyZXNzQmFyLnJlbW92ZUNsYXNzKCdleHBhbmRlZCcpO1xuICB9XG4gIGF1ZGlvUGxheWVyLnByb3RvdHlwZS5wbGF5VHJhY2sgPSBmdW5jdGlvbigkYXVkaW9QbGF5ZXIpe1xuXG4gICAgZ2EoJ3NlbmQnLCAnZXZlbnQnLCAnTWl4JywgJ3BsYXknLCBcbiAgICAgIHRoaXMuc3R1YiwgdGhpcy5yYXRpbmcpO1xuXG4gICAgdGhpcy5wYXVzZUFsbE90aGVycygpO1xuICAgIHRoaXMudHJhY2sucGxheSgpO1xuICAgIHRoaXMuJGF1ZGlvUGxheWVyLmFkZENsYXNzKCdwbGF5aW5nJyk7XG4gICAgdGhpcy4kcHJvZ3Jlc3NCYXIuYWRkQ2xhc3MoJ2V4cGFuZGVkJyk7XG5cbiAgICB0aGlzLnN0YXJ0SW50ZXJ2YWwoKTtcblxuICAgIHRoaXMuJGN1cnJlbnRUaW1lLnRleHQodGhpcy5jdXJyZW50VGltZVN0cmluZygpKTtcbiAgICB0aGlzLiRkaXZpZGVyLnNob3coKTtcbiAgICB0aGlzLiRtaXhMZW5ndGgudGV4dCh0aGlzLmR1cmF0aW9uU3RyaW5nKCkpO1xuICB9XG5cbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnN0YXJ0SW50ZXJ2YWwgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMudHJhY2tSZWZyZXNoVGltZXIgPSBzZXRJbnRlcnZhbCh0aGlzLnRpY2suYmluZCh0aGlzKSwgMTAwKTtcbiAgfVxuICBhdWRpb1BsYXllci5wcm90b3R5cGUuY2xlYXJJbnRlcnZhbCA9IGZ1bmN0aW9uKCl7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRyYWNrUmVmcmVzaFRpbWVyKTtcbiAgfVxuXG4gIC8vIE9uZSB0aWNrIG9mIHRoZSBzb25nIHJvbGxzIGJ5IGFuZCB0aGUgdGltZSBpcyB1cGRhdGVcbiAgYXVkaW9QbGF5ZXIucHJvdG90eXBlLnRpY2sgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuJGN1cnJlbnRUaW1lLnRleHQodGhpcy5jdXJyZW50VGltZVN0cmluZygpKTtcbiAgICB0aGlzLnVwZGF0ZVByb2dyZXNzQmFyKCk7XG4gICAgdGhpcy5zZW5kUHJvZ3Jlc3NFdmVudHMoKTtcbiAgfVxuXG4gIGF1ZGlvUGxheWVyLnByb3RvdHlwZS51cGRhdGVQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHBsYXlQZXJjZW50YWdlID0gKHRoaXMudHJhY2suY3VycmVudFRpbWUgLyB0aGlzLnRyYWNrLmR1cmF0aW9uKSAqIDEwMDtcbiAgICB0aGlzLiRwbGF5ZWQuY3NzKCd3aWR0aCcsIHBsYXlQZXJjZW50YWdlKyclJyk7XG4gIH1cblxuICBhdWRpb1BsYXllci5wcm90b3R5cGUuY3VycmVudFRpbWVTdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiB0aGlzLnRpbWVTdHJpbmcodGhpcy50cmFjay5jdXJyZW50VGltZSk7XG4gIH1cblxuICBhdWRpb1BsYXllci5wcm90b3R5cGUuZHVyYXRpb25TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiB0aGlzLnRpbWVTdHJpbmcodGhpcy50cmFjay5kdXJhdGlvbik7XG4gIH1cblxuICAvLyBSZXR1cm5zIGEgdGltZSBsaWtlIE1NOlNTXG4gIGF1ZGlvUGxheWVyLnByb3RvdHlwZS50aW1lU3RyaW5nID0gZnVuY3Rpb24odGltZSl7XG5cbiAgICBpZihpc05hTih0aW1lKSlcbiAgICB7IC8vZWVrLCB0cnkgYWdhaW4uIEhhcmQgdG8gcmVwcm9kdWNlXG4gICAgICBpZihpc05hTih0aGlzLnRyYWNrLmR1cmF0aW9uKSl7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1lbHNlIHtcbiAgICAgICAgdGhpcy50cmFjay5kdXJhdGlvbjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgc2Vjb25kcyA9IFwiMFwiICsgTWF0aC5yb3VuZCh0aW1lJTYwKTtcbiAgICBzZWNvbmRzID0gc2Vjb25kcy5zdWJzdHIoc2Vjb25kcy5sZW5ndGgtMik7XG5cbiAgICByZXR1cm4gIE1hdGgucm91bmQodGltZS82MCkrJzonK3NlY29uZHM7XG4gIH1cblxuICAvLyBQbGF5IGlmIHBhdXNlZCwgcGF1c2UgaWYgcGxheWluZ1xuICBhdWRpb1BsYXllci5wcm90b3R5cGUudG9nZ2xlUGxheVBhdXNlID0gZnVuY3Rpb24oKXtcbiAgICB0aGlzLmlzUGF1c2VkKCkgPyB0aGlzLnBsYXlUcmFjaygpIDogdGhpcy5wYXVzZVRyYWNrKCk7XG4gIH1cblxuICBhdWRpb1BsYXllci5wcm90b3R5cGUuc2VlayA9IGZ1bmN0aW9uKGV2ZW50KXtcblxuICAgIHZhciBwbGF5UGVyY2VudGFnZSA9IGV2ZW50Lm9mZnNldFggLyAkKGV2ZW50LnRhcmdldCkud2lkdGgoKTtcbiAgICB0aGlzLnRyYWNrLmN1cnJlbnRUaW1lID0gcGxheVBlcmNlbnRhZ2UgKiB0aGlzLnRyYWNrLmR1cmF0aW9uO1xuICAgIHRoaXMudXBkYXRlUHJvZ3Jlc3NCYXIoKTtcbiAgfSAgXG5cbiAgJCgnYm9keScpLm9uKCdjbGljaycsICcucGxheS1wYXVzZScsIGZ1bmN0aW9uKCl7XG4gICAgdmFyIHBsYXllciA9IG5ldyBhdWRpb1BsYXllcigkKHRoaXMpLmNsb3Nlc3QoJy5hdWRpby1wbGF5ZXInKS5lcSgwKSk7XG4gICAgcGxheWVyLnRvZ2dsZVBsYXlQYXVzZSgpO1xuICB9KTtcblxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJy5wcm9ncmVzcy1iYXInLCBmdW5jdGlvbihldmVudCl7XG4gICAgdmFyIHBsYXllciA9IG5ldyBhdWRpb1BsYXllcigkKHRoaXMpLmNsb3Nlc3QoJy5hdWRpby1wbGF5ZXInKS5lcSgwKSk7XG4gICAgcGxheWVyLnNlZWsoZXZlbnQpO1xuICB9KTtcblxuICAvL3NlbmQgZ29vZ2xlLWFuYWx5dGljcyBzdGF0cyBmb3IgYSBtaXggZG93bmxvYWRcbiAgJCgnYm9keScpLm9uKCdjbGljaycsICcuZG93bmxvYWQnLCBmdW5jdGlvbihldmVudCl7XG4gICAgZ2EoJ3NlbmQnLCAnZXZlbnQnLCAnTWl4JywgJ2Rvd25sb2FkJywgXG4gICAgICAkKHRoaXMpLmNsb3Nlc3QoJy5hdWRpby1wbGF5ZXInKS5hdHRyKCdpZCcpLCBcbiAgICAgICQodGhpcykuY2xvc2VzdCgnLmF1ZGlvLXBsYXllcicpLmRhdGEoJ3JhdGluZycpKTtcbiAgfSk7XG5cbn0pOyAiLCIgIFxuLyogXG4gIEFuaW1hdGUgcmF0aW5ncyBiYXIgYnkgY2hhbmdpbmcgb3BhY2l0eSBvZiBzZXZlcmFsIGJsb2Nrc1xuICAqL1xuJChmdW5jdGlvbigpe1xuICBcbiAgLy8gIDYwcy8xMjVicG0gPSA0ODBtc1xuICB2YXIgQU5JTUFUSU9OX1BFUklPRCA9ICg2MC4wLzEyNSkqMTAwMDtcbiAgdmFyIERFRkFVTFRfT1BBQ0lUWSA9ICcwLjQnO1xuICB2YXIgSU5DUkVBU0VEX09QQUNJVFkgPSAnMC41JztcbiAgdmFyICRyYXRpbmdfYmxvY2tzID0gJCgnLmJvdHRvbS1iYXIgLnJhdGluZy1ibG9jaycpO1xuICB2YXIgbnVtX3JhdGluZ3MgPSAkcmF0aW5nX2Jsb2Nrcy5sZW5ndGg7XG4gIHZhciBvcmlnaW5hbF9ibG9ja19oZWlnaHQgPSAkcmF0aW5nX2Jsb2Nrcy5lcSgwKS5oZWlnaHQoKTtcblxuICBpZihudW1fcmF0aW5ncyA9PT0gMCl7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gRXZlcnkgeCBtcywgZG8uLi5cbiAgLy8gIHJlc2V0IGFsbCBvcGFjaXRpZXNcbiAgLy8gIGNob29zZSB4IHJhbmRvbSByYXRpbmcgYmxvY2tzIHRvIGRhcmtlblxuICAvLyAgY2hvb3NlIGEgcmFuZG9tIGJsb2NrIGZyb20gdGhhdCBncm91cCB0byBkYXJrZW4sIG92ZXJsYXAgb2tcbiAgLy8gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gIHNldEludGVydmFsKCgpID0+IHtcblxuICAgIC8vZWFjaCB0aW1lLCBhIGRpZmZlcmVudCBudW1iZXIgb2YgYmxvY2tzIGFyZSBjaG9zZW5cbiAgICB2YXIgYmxvY2tzX3RvX2JsYW5rID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKm51bV9yYXRpbmdzKSsxO1xuICAgIFxuICAgICRyYXRpbmdfYmxvY2tzLm5vdCgnLmFjdGl2ZScpLmNzcygnb3BhY2l0eScsIERFRkFVTFRfT1BBQ0lUWSk7XG4gICAgICAgICAgICAgICAgICAvLyAuY3NzKCdoZWlnaHQnLCBvcmlnaW5hbF9ibG9ja19oZWlnaHQrJ3B4Jyk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJsb2Nrc190b19ibGFuazsgaSsrKSB7XG4gICAgICB2YXIgcmFuZF9ibG9ja19pbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpudW1fcmF0aW5ncykrMTtcblxuICAgICAgaWYoISRyYXRpbmdfYmxvY2tzLmVxKHJhbmRfYmxvY2tfaW5kZXgpLmhhc0NsYXNzKCdhY3RpdmUnKSl7XG4gICAgICAgICRyYXRpbmdfYmxvY2tzLmVxKHJhbmRfYmxvY2tfaW5kZXgpXG4gICAgICAgICAgICAgICAgICAgICAgLmNzcygnb3BhY2l0eScsIElOQ1JFQVNFRF9PUEFDSVRZKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIEFOSU1BVElPTl9QRVJJT0QpO1xuXG5cbiAgLy8gY29udHJvbCBzaG93aW5nIFYtcmF0aW5nIGRlc2NyaXB0aW9ucyBvbiBob3ZlciBvZiBWLWNvbG9yIGJ1dHRvblxuICAkKCcuYm90dG9tLWJhciA+IGRpdicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgdmFyIHJhdGluZyA9ICQodGhpcykuZmluZCgnLnJhdGluZy1ibG9jaycpLmRhdGEoJ3JhdGluZycpO1xuICAgIHNob3dBbmRIaWdobGlnaHRSYXRpbmcocmF0aW5nKTtcbiAgfSk7XG5cblxuICBmdW5jdGlvbiBzaG93QW5kSGlnaGxpZ2h0UmF0aW5nKHJhdGluZyl7XG4gICAgXG4gICAgLy9oaWRlIGFsbCBvdGhlciBkZXNjcmlwdGlvbnNcbiAgICAkKCcudi1kZXNjcmlwdGlvbnMgPiBwJylcbiAgICAgIC5ub3QoJy52LWRlc2NyaXB0aW9ucyA+IHBbZGF0YS1yYXRpbmc9XCInK3JhdGluZysnXCJdJylcbiAgICAgIC5oaWRlKCk7XG5cbiAgICAvL3JlbW92ZSBvdGhlciBhY3RpdmUgb3BhY2l0aWVzXG4gICAgJCgnLmJvdHRvbS1iYXIgPiBkaXYgLnJhdGluZy1ibG9jaycpXG4gICAgICAubm90KCcuYm90dG9tLWJhciA+IGRpdiAucmF0aW5nLWJsb2NrW2RhdGEtcmF0aW5nPVwiJytyYXRpbmcrJ1wiXScpXG4gICAgICAuY3NzKCdvcGFjaXR5JywgREVGQVVMVF9PUEFDSVRZKVxuICAgICAgLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgICQoJy5ib3R0b20tYmFyID4gZGl2IC5yYXRpbmctYmxvY2tbZGF0YS1yYXRpbmc9XCInK3JhdGluZysnXCJdJylcbiAgICAgIC5jc3MoJ29wYWNpdHknLCAxKVxuICAgICAgLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgICQoJy52LWRlc2NyaXB0aW9ucyA+IHBbZGF0YS1yYXRpbmc9XCInK3JhdGluZysnXCJdJykuc2hvdygpO1xuICB9XG59KTtcblxuXG4kKGZ1bmN0aW9uKCl7XG5cbiAgLy9nZXQgdGhlIHN0dWIgZnJvbSB0aGUgdXJsLCBsaWtlIGRqbW91bnRhaW5vdXMuY29tP2JsdWVwcmludC0xOS13YXJtdXBcbiAgdmFyIHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gucmVwbGFjZShcIj9cIiwgXCJcIik7XG4gXG4gIC8vc2Nyb2xsIHRoYXQgZWxlbWVudCdzIHRvcCAgXG4gIC8vIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgXG5cbiAgLy8gICAvLyAkKCdodG1sLCBib2R5Jykuc2Nyb2xsVG9wKCQoJy4nK3NlYXJjaCkub2Zmc2V0KCkudG9wLTMwMCk7XG4gIC8vICAgLy8gJCgnLm1peCcpLm5vdCgnLicrc2VhcmNoKS5jc3MoJ29wYWNpdHknLCAwLjYpO1xuICAvLyAgIC8vICQoJy5taXgtZ3JvdXBfX3RpdGxlLCAuZ3JvdXAtZGVzY3JpcHRpb24nKS5jc3MoJ29wYWNpdHknLCAwLjYpO1xuICAvLyB9LCAxODAwKTsgXG5cbiAgLy93aGVuIGFueXRoaW5nIGlzIGNsaWNrZWQsIHNldCB0aGUgb3BhY2l0eSBvZiB0aGUgbWl4ZXMgYmFjayB0byAxXG4gICQoJyonKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgJCgnLm1peCcpLmNzcygnb3BhY2l0eScsIDEpO1xuICB9KTsgXG4gICAgXG4gICQoJyNtaXhlcycpLm9uKCdjbGljaycsICcubWl4X19kZXRhaWxzIC5yYXRpbmcnLCBmdW5jdGlvbigpe1xuICAgICQoJy5yYXRpbmctYmxvY2tbZGF0YS1yYXRpbmc9XCInKyQodGhpcykuZGF0YSgncmF0aW5nJykrJ1wiXScpLmNsb3Nlc3QoJ2RpdicpLnRyaWdnZXIoJ2hvdmVyJyk7XG4gICAgJCgnLnJhdGluZy1ibG9ja1tkYXRhLXJhdGluZz1cIicrJCh0aGlzKS5kYXRhKCdyYXRpbmcnKSsnXCJdJykuY2xvc2VzdCgnZGl2JykudHJpZ2dlcignY2xpY2snKTtcbiAgICAkKCdodG1sLCBib2R5Jykuc2Nyb2xsVG9wKCQoJy5ib3R0b20tYmFyJykub2Zmc2V0KCkudG9wLTEzMCk7XG4gIH0pO1xuICBcbn0pOyAgIiwiJChmdW5jdGlvbiAgKCkge1xuXG4gIC8vIG1peGVzIE1VU1QgYmUgbmFtZWQgZGotbW91dGFpbm91cy17c2x1Z30uKG1wMy9tNGEpXG4gIC8vIGkuZS4gZGotbW91bnRhaW5vdXMtdmEtdGVjaC1ob3VzZVxuXG4gIHZhciBjYWxtX21peGVzID0ge1xuICAgIG1peGVzOiBbXG4gICAgICAvL25ldyBtaXggZ29lcyBoZXJlXG4gICAgICB7XG4gICAgICAgIHRpdGxlOiBcIlRoZSBFaWdlclwiLFxuICAgICAgICBnZW5yZXM6IFwiVGVjaCBIb3VzZVwiLFxuICAgICAgICBkYXRlOiBcIlNlcHQgMjAxNlwiLFxuICAgICAgICBzbHVnOiBcInZhLXRlY2gtaG91c2VcIixcbiAgICAgICAgcmF0aW5nOiAzXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB0aXRsZTogXCJHYXJpYmFsZGlcIixcbiAgICAgICAgZ2VucmVzOiBcIkRlZXAgSG91c2VcIixcbiAgICAgICAgZGF0ZTogXCJKdW5lIDIwMTZcIixcbiAgICAgICAgc2x1ZzogXCJ2YS1kZWVwLWhvdXNlLXYyXCIsXG4gICAgICAgIHJhdGluZzogMlxuICAgICAgfSxcbiAgICBdXG4gIH07XG5cbiAgdmFyIGludGVuc2VfbWl4ZXMgPSB7XG4gICAgbWl4ZXM6IFtcbiAgICAgIC8vbmV3IG1peCBnb2VzIGhlcmVcbiAgICAgIHtcbiAgICAgICAgdGl0bGU6IFwiQmx1ZXByaW50IDE5dGggV2FybXVwXCIsXG4gICAgICAgIGdlbnJlczogXCJSZXp6IEdyaXogR3JpbWUgVy5TLk4gREZyYW5jaXNcIixcbiAgICAgICAgZGF0ZTogXCJPY3RvYmVyIDIwMTZcIixcbiAgICAgICAgc2x1ZzogXCJibHVlcHJpbnQtMTktd2FybXVwXCIsXG4gICAgICAgIHJhdGluZzogOVxuICAgICAgfSx7XG4gICAgICAgIHRpdGxlOiBcIkxpdmUgQCBCaXJ0aFJhdmUgMjAxNlwiLFxuICAgICAgICBnZW5yZXM6IFwiQmFzcyBGdW5rLCBUcmFwLCBEdWJcIixcbiAgICAgICAgZGF0ZTogXCJTZXB0IDI0LCAyMDE2XCIsXG4gICAgICAgIHNsdWc6IFwibGl2ZS1iaXJ0aHJhdmUtMjAxNi1iYXNzLWZ1bmstZHViXCIsXG4gICAgICAgIHJhdGluZzogOFxuICAgICAgfSx7IFxuICAgICAgICB0aXRsZTogXCJCbGFjayBUdXNrXCIsXG4gICAgICAgIGdlbnJlczogXCJUcmFwICYgRHVic3RlcFwiLFxuICAgICAgICBkYXRlOiBcIkF1Z3VzdCAyMDE2XCIsXG4gICAgICAgIHNsdWc6IFwidmEtZHVidHJhcFwiLFxuICAgICAgICByYXRpbmc6IDlcbiAgICAgIH0se1xuICAgICAgICB0aXRsZTogXCJTZXZlbiBMaW9ucyB3YXJtdXBcIixcbiAgICAgICAgZ2VucmVzOiBcIkRyZWFtc3RlcFwiLFxuICAgICAgICBkYXRlOiBcIk9jdG9iZXIgMjAxNlwiLFxuICAgICAgICBzbHVnOiBcInNldmVuLWxpb25zLXdhcm0tdXAtbWl4XCIsXG4gICAgICAgIHJhdGluZzogN1xuICAgICAgfVxuICAgIF1cbiAgfTsvLyBpbnRlbnNlIG1peGVzXG5cbiAgLy8gLy9pbmplY3QgaGFuZGxlYmFycyB0ZW1wbGF0ZXMgd2l0aCBtaXggZGF0YVxuICBpbmplY3RUZW1wbGF0ZXMoaW50ZW5zZV9taXhlcywgICdpbnRlbnNlJyk7IFxuICBpbmplY3RUZW1wbGF0ZXMoY2FsbV9taXhlcywgICAgICdjYWxtJyk7XG4gIFxuICBmdW5jdGlvbiBpbmplY3RUZW1wbGF0ZXMoZGF0YSwgdHlwZSl7XG5cbiAgICB2YXIgaHRtbCA9IE15QXBwLnRlbXBsYXRlcy5taXhlcyhkYXRhKTtcbiAgICAkKCcjbWl4ZXMtdG1wbC0nK3R5cGUpLmh0bWwoaHRtbCk7XG4gIH0gIFxuXG5cbn0pO1xuICBcblxuICJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
